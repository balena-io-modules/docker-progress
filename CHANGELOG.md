# Change Log

All notable changes to this project will be documented in this file
automatically by Versionist. DO NOT EDIT THIS FILE MANUALLY!
This project adheres to [Semantic Versioning](http://semver.org/).

# v5.4.1
## (2026-01-30)

* awaitRegistryStream: Handle error events on source stream [Christina Ying Wang]

# v5.4.0
## (2025-12-03)

* pull/push/build: Support detecting the result digest when pushing only the reference of a pre-built image [Thodoris Greasidis]

# v5.3.4
## (2025-12-03)

* pull: fix digest hash parsing [Tuetuopay]

# v5.3.3
## (2025-11-28)

* Update flowzone workflow to allow external contributions [Thodoris Greasidis]

# v5.3.2
## (2025-11-28)

* Fix TS errors for the latest dockerode [Thodoris Greasidis]

# v5.3.1
## (2025-05-15)

* Make abortSignal optional in pull/push options [Felipe Lalanne]

# v5.3.0
## (2025-05-12)

* Support AbortSignal option for image push/pull [Christina Ying Wang]

# v5.2.7
## (2025-04-10)

* Update @balena/lint to 9.x [Pagan Gazzard]

# v5.2.6
## (2025-04-02)

* Update dependency rimraf to v6 [balena-renovate[bot]]

# v5.2.5
## (2025-03-25)

* Update dependency @balena/lint to v8 [balena-renovate[bot]]

# v5.2.4
## (2025-02-12)

* Propagate NodeJS Error from stream directly [Christina Ying Wang]

# v5.2.3
## (2024-01-05)

* Make use of nullish coalescing [Pagan Gazzard]

# v5.2.2
## (2024-01-05)

* Reduce lodash usage [Pagan Gazzard]

# v5.2.1
## (2024-01-05)

* Update dependencies [Pagan Gazzard]

# v5.2.0
## (2023-06-30)

* Add support for tracking delta generation progress [Akis Kesoglou]

# v5.1.4
## (2023-06-30)

* Build with Flowzone [Akis Kesoglou]

# v5.1.3
## (2022-05-11)

* Reject on the stream closing if it has not already ended successfully [Pagan Gazzard]

# v5.1.2
## (2022-05-10)

* Update dependencies [Pagan Gazzard]

# v5.1.1
## (2022-05-10)

* Avoid breaking changes to PushPullOptions required properties [Kyle Harding]

# v5.1.0
## (2022-03-10)

* Add support for building images with progress [Felipe Lalanne]

# v5.0.1
## (2021-09-22)

* Fix for bad progress values from some registries causing a crash [Paul Jonathan Zoulin]

# v5.0.0
## (2021-05-05)

* Convert to TypeScript. BREAKING: constructor and push/pull interfaces [Paulo Castro]
* Delete legacy.coffee and auto-convert CoffeeScript to JavaScript [Paulo Castro]
* Add 'package-lock=false' to '.npmrc' (libs shouldn't lock dependencies) [Paulo Castro]
* Update license to Apache 2.0 [Paulo Castro]

# v4.0.3
## (2020-08-17)

* Update to balena-lint 5.x [Pagan Gazzard]

# v4.0.2
## (2020-08-17)

* Add .versionbot/CHANGELOG.yml for nested changelogs [Pagan Gazzard]

## 4.0.1 - 2020-03-03

* Update dependencies [Pagan Gazzard]

## 4.0.0 - 2019-03-20

* Detect error events in push/pull progress streams [Paulo Castro]

## 3.0.5 - 2019-03-15

* Fix "Progress error: Cannot read property 'startsWith' of undefined" [Paulo Castro]

## 3.0.4 - 2019-03-05

* Catch 'unknown blob' errors in progress streams [Paulo Castro]

## 3.0.3 - 2018-12-03

* Replace followProgress to avoid caching push/pull state [Cameron Diver]

## v3.0.2 - 2018-10-10

* Ensure latest versions of balena-engine can be identified [Akis Kesoglou]

## v3.0.1 - 2017-12-05

* Expose docker property of docker-progress #42 [Cameron Diver]

## v3.0.0 - 2017-12-05

* Pull and Push promises resolve to the registry digest of the image #40 [Andreas Fitzek]

## v2.8.1 - 2017-11-01

* Specify the promises as bluebird promises in typings #38 [Cameron Diver]

## v2.8.0 - 2017-10-31

* Add typings for index.coffee #37 [Cameron Diver]

## v2.7.2 - 2017-10-16

* Identify Balena #35 [Akis Kesoglou]

## v2.7.1 - 2017-10-04

* Use custom reporter for Balanea #34 [Akis Kesoglou]

## v2.7.0 - 2017-10-03

* Handle combined download and extraction stages #33 [Akis Kesoglou]

## v2.6.4 - 2017-09-06

* Search fo any tag instead of just 'latest' in pushProgress. #31 [Alexis Svinartchouk]

## v2.6.3 - 2017-08-28

* Add empty .npmignore to avoid js files being ignored #29 [Pablo Carranza Velez]

## v2.6.2 - 2017-08-16

* Avoid calling the docker API to check if the dockerToolbelt option is valid #27 [Pablo Carranza Velez]

## v2.6.1 - 2017-07-17

* Remove the .js files from the git repository [Pablo Carranza Velez]

## v2.6.0 - 2017-07-14

* Allow passing a dockerToolbelt object in the options, and update docker-toolbelt to 3.0.1 [Pablo Carranza Velez]

## v2.5.1 - 2017-07-14

* Adapt the changelog to the versionist format [Pablo Carranza Velez]

## v2.5.0 - 2017-03-24

* Forward options object to docker pull

## v2.4.4

* Improved parsing Docker client version anticipating version-scheme changes in Docker

## v2.4.3

* Fixed getting registry version

## v2.4.2

* Restore public-facing APIs that were incorrectly removed in v2.4.0

## v2.4.1

* Fix packaging to include new Coffee files

## v2.4.0

* Deprecated support for Docker<1.10
* Added support for pulling from and pushing to registry v2

## v2.3.3

* Fixed downloading the entire layer to get the size

## v2.3.2

* Updated to docker-toolbelt 1.3.1

## v2.3.1

* Fix use of `_.sum` for lodash 4
* Do not export getRegistryAndName and use docker-toolbelt instead

## v2.3.0

* Updated to bluebird 3
* Updated to lodash v4
* Updated to coffee-script 1.11

## v2.2.0

* Support pulling from registry v2
* Correctly handle progress during concurrent push.
* Added linting.

## v2.1.0

* Correctly handle progress during concurrent pulls.

## v2.0.1

* Use 443 as the default registry port.

## v2.0.0

* Add toString() to Registry class and export getRegistryAndName().
* Changed pull/push to fall back to calling onProgress without `downloadedSize`, `totalSize`, and `percentage` in the case where fetching size info fails, rather than failing with an error.
* Fix a race condition where early layers could complete before we had completed fetching all the layer sizes, meaning it would not be accounted for in `downloadedSize` and `percentage`.

## v1.1.2

* Capped reported percentage at 100.

## v1.1.1

* Fix registry references in errors.

## v1.1.0

* Added support for listing total progress of a docker push.

## v1.0.0

* Added support for listing total progress of a docker pull.
